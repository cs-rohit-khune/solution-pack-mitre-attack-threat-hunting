{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "HUNTS - LSASS Driver (T1547.008)",
    "aliasName": null,
    "tag": "ATT&CK, LSASS_Driver, Execution, Persistence",
    "description": "Identifies process execution via loading an illegitimate LSASS driver (DLL). This technique can be used to execute a binary whenever LSASS executes.",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [
        "sourceIP",
        "destinationIP",
        "processname",
        "processID",
        "processGUID",
        "parentprocessname",
        "parentprocessGUID",
        "accountname",
        "computername",
        "commandline",
        "sourcetool"
    ],
    "synchronous": false,
    "lastModifyDate": 1644165542,
    "collection": "\/api\/3\/workflow_collections\/11dc1218-970f-4eaf-ad2f-0e9d353445e5",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/c9035e0b-e89f-450a-a3b6-079006a84b80",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Deduplicate Comments",
            "description": null,
            "arguments": {
                "arguments": {
                    "hunt_iri": "{{vars.input.records[0]['@id']}}"
                },
                "step_variables": [],
                "workflowReference": "\/api\/3\/workflows\/3fd311be-a1c6-41c7-99a3-8794b33d8f8a"
            },
            "status": null,
            "top": "430",
            "left": "2075",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "uuid": "54369d88-df12-4d0b-892d-2e25402f18b5",
            "id": 4348
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Results 1",
            "description": null,
            "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                    "sid": "{'value': \"{{vars.steps.Splunk_query_for_illegitimate_DLL_load.data.sid}}\"}",
                    "additional_args": "{\"a\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                    "delay": "1",
                    "retries": "300",
                    "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
            },
            "status": null,
            "top": "510",
            "left": "1425",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "00a13090-fa74-4f80-83a2-1be49c9f1a9b",
            "id": 4349
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Results 2",
            "description": null,
            "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                    "sid": "{'value': \"{{vars.steps.Splunk_query_for_DLL_load_from_illegitimate_LSASS.data.sid}}\"}",
                    "additional_args": "{\"a\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                    "delay": "1",
                    "retries": "300",
                    "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
            },
            "status": null,
            "top": "830",
            "left": "1425",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "5a621a10-3df8-4b33-a1df-594bc059581c",
            "id": 4350
        },
        {
            "@type": "WorkflowStep",
            "name": "Set Splunk hunt times",
            "description": null,
            "arguments": {
                "splunkHuntEnd": "{% if vars.input.records[0].huntEnd %}latest={{vars.input.records[0].huntEnd}}{% endif %}",
                "splunkHuntStart": "earliest={{vars.input.records[0].huntStart}}"
            },
            "status": null,
            "top": "670",
            "left": "775",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "df303e97-0f23-4ab7-ad1b-4a8fde803a5b",
            "id": 4351
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Results 3",
            "description": null,
            "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                    "sid": "{'value': \"{{vars.steps.Splunk_query_for_illegitimate_LSASS.data.sid}}\"}",
                    "additional_args": "{\"a\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                    "delay": "1",
                    "retries": "300",
                    "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
            },
            "status": null,
            "top": "670",
            "left": "1425",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "0197411d-b551-4130-a3f2-585b11dfd8bf",
            "id": 4352
        },
        {
            "@type": "WorkflowStep",
            "name": "Elastic query for illegitimate LSASS",
            "description": null,
            "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                    "index": "logstash-beats-*",
                    "query": "event_type:sysmon AND event_id:\"1\" AND @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND image_path:*lsass.exe NOT image_path:C\\:\\\\Windows\\\\System32\\\\lsass.exe NOT image_path:C\\:\\\\Windows\\\\SysWOW64\\\\lsass.exe",
                    "run_as_user": ""
                },
                "version": "2.2.1",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "mock_result": "{\n  \"data\": {\n    \"hits\": {\n      \"hits\": [],\n      \"total\": {\n        \"value\": 0,\n        \"relation\": \"eq\"\n      },\n      \"max_score\": null\n    },\n    \"took\": 520,\n    \"_shards\": {\n      \"total\": 95,\n      \"failed\": 0,\n      \"skipped\": 0,\n      \"successful\": 95\n    },\n    \"timed_out\": false\n  },\n  \"status\": \"Success\",\n  \"message\": \"\",\n  \"operation\": null\n}",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
            },
            "status": null,
            "top": "190",
            "left": "1425",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "53f777da-d699-491c-97aa-4379cebfdfa5",
            "id": 4353
        },
        {
            "@type": "WorkflowStep",
            "name": "Create and Link Elastic Alert 1",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{vars.steps.Elastic_query_for_illegitimate_DLL_load.data.hits.hits}}",
                    "parallel": false,
                    "condition": ""
                },
                "arguments": {
                    "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                    "url": "",
                    "source": "{{vars.item._source.source_name}}",
                    "comment": "SIEM query indicated LSASS.exe attempted to load a DLL from a non-standard directory on {{vars.item._source.beat.hostname}} at {{vars.item._source.event_data.UtcTime}}.",
                    "huntIRI": "{{vars.input.records[0]['@id']}}",
                    "service": "",
                    "filePath": "{{vars.item._source.image_path}}",
                    "hostName": "{{vars.item._source.beat.hostname}}",
                    "sourceIP": "null",
                    "userName": "{{vars.item._source.username}}",
                    "alertName": "ATT&CK-LSASS Driver-{{vars.item._source.event_data.ImageLoaded}} by LSASS",
                    "alertType": "{{\"AlertType\" | picklist(\"Boot or Logon Autostart Execution\", \"@id\")}}",
                    "epochTime": "{{ arrow.get(vars.item._source.event_data.UtcTime).timestamp }}",
                    "eventName": "",
                    "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                    "processID": "{{vars.item._source.event_data.ProcessId}}",
                    "technique": "LSASS Driver-Illegitimate DLL Loaded",
                    "sourceData": "{{vars.item}}",
                    "sourceTool": "{{vars.item._source.source_name}}",
                    "commandline": "{{vars.item._source.event_data.CommandLine}}",
                    "description": "LSASS.exe attempted to execute a DLL file located in a nonstandard directory. This could be an attempt by an adversary in the network to execute their code to gain persistence or further access to the system. The DLL being loaded by LSASS.exe should be evaluated to determine its legitimacy.",
                    "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                    "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                    "registryKey": "",
                    "sourceImage": "",
                    "targetImage": "{{vars.item._source.event_data.ImageLoaded}}",
                    "computerName": "{{vars.item._source.computer_name}}",
                    "destinationIP": "null",
                    "mitre_tech_id": "T1547.008",
                    "parentProcess": "{{vars.item._source.parent_image_path}}",
                    "scheduledTask": "",
                    "bitstransferid": "",
                    "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                    "bytestransferred": "",
                    "registryKeyValue": "",
                    "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                    "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "\/api\/3\/workflows\/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
            },
            "status": null,
            "top": "30",
            "left": "1750",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "uuid": "cfad32ce-5355-46c4-844d-9b2bd8a33fbc",
            "id": 4354
        },
        {
            "@type": "WorkflowStep",
            "name": "Which SIEM",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "step_iri": "\/api\/3\/workflow_steps\/dae78ba7-66b6-4c7d-920a-8988c96fdbfd",
                        "condition": "{{ vars.input.params.siem.itemValue == \"Elastic\" }}"
                    },
                    {
                        "step_iri": "\/api\/3\/workflow_steps\/df303e97-0f23-4ab7-ad1b-4a8fde803a5b",
                        "condition": "{{ vars.input.params.siem.itemValue == \"Splunk\" }}"
                    }
                ]
            },
            "status": null,
            "top": "430",
            "left": "450",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "uuid": "02c023f4-78c9-4470-a215-d197bd64058b",
            "id": 4355
        },
        {
            "@type": "WorkflowStep",
            "name": "Elastic query for illegitimate DLL load",
            "description": null,
            "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                    "index": "logstash-beats-*",
                    "query": "event_type:sysmon AND event_id:\"7\" AND @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND (image_path:\"C:\\\\Windows\\\\System32\\\\lsass.exe\" OR image_path:\"C:\\\\Windows\\\\SysWOW64\\\\lsass.exe\") NOT event_data.ImageLoaded:C\\:\\\\Windows\\\\System32\\\\*  NOT event_data.ImageLoaded:C\\:\\\\Windows\\\\SysWOW64\\\\* NOT event_data.ImageLoaded:C\\:\\\\Program\\ Files\\\\* NOT event_data.ImageLoaded:C\\:\\\\Program\\ Files\\ \\(x86\\)\\\\*",
                    "run_as_user": ""
                },
                "version": "2.2.1",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "mock_result": "{\n  \"data\": {\n    \"hits\": {\n      \"hits\": [],\n      \"total\": {\n        \"value\": 0,\n        \"relation\": \"eq\"\n      },\n      \"max_score\": null\n    },\n    \"took\": 520,\n    \"_shards\": {\n      \"total\": 95,\n      \"failed\": 0,\n      \"skipped\": 0,\n      \"successful\": 95\n    },\n    \"timed_out\": false\n  },\n  \"status\": \"Success\",\n  \"message\": \"\",\n  \"operation\": null\n}",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
            },
            "status": null,
            "top": "30",
            "left": "1425",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "400ab8c0-352c-4abe-ae3a-9284e13c3eb3",
            "id": 4356
        },
        {
            "@type": "WorkflowStep",
            "name": "Create and Link Elastic Alert 3",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{vars.steps.Elastic_query_for_illegitimate_LSASS.data.hits.hits}}",
                    "parallel": false,
                    "condition": ""
                },
                "arguments": {
                    "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                    "url": "",
                    "source": "{{vars.item._source.source_name}}",
                    "comment": "SIEM query indicated that a file named LSASS.exe was executed from a nonstandard directory on {{vars.item._source.beat.hostname}} at {{vars.item._source.event_data.UtcTime}}.",
                    "huntIRI": "{{vars.input.records[0]['@id']}}",
                    "service": "",
                    "filePath": "{{vars.item._source.image_path}}",
                    "hostName": "{{vars.item._source.beat.hostname}}",
                    "sourceIP": "",
                    "userName": "{{vars.item._source.username}}",
                    "alertName": "ATT&CK-LSASS Driver-Lsass.exe loaded from {{vars.item._source.image_path | regex_search('[^\\*?\"<>|\\r\\n]+(?=lsass\\.exe)')}}",
                    "alertType": "{{\"AlertType\" | picklist(\"Boot or Logon Autostart Execution\", \"@id\")}}",
                    "epochTime": "{{ arrow.get(vars.item._source.event_data.UtcTime).timestamp }}",
                    "eventName": "",
                    "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                    "processID": "{{vars.item._source.event_data.ProcessId}}",
                    "technique": "LSASS Driver-Illegitimate LSASS Executed",
                    "sourceData": "{{vars.item}}",
                    "sourceTool": "{{vars.item._source.source_name}}",
                    "commandline": "{{vars.item._source.event_data.CommandLine}}",
                    "description": "A process named LSASS.exe was invoked from a nonstandard directory. This may be an attempt by an adversary to execute their own code while masquerading as a legitimate process. The suspicious LSASS.exe executable should be investigated for indicators of malicious activity.",
                    "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                    "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                    "registryKey": "",
                    "sourceImage": "",
                    "targetImage": "",
                    "computerName": "{{vars.item._source.computer_name}}",
                    "destinationIP": "",
                    "mitre_tech_id": "T1547.008",
                    "parentProcess": "{{vars.item._source.parent_image_path}}",
                    "scheduledTask": "",
                    "bitstransferid": "",
                    "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                    "bytestransferred": "",
                    "registryKeyValue": "",
                    "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                    "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "\/api\/3\/workflows\/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
            },
            "status": null,
            "top": "190",
            "left": "1750",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "uuid": "53b26cf0-d207-45d6-b697-a6b6c7abe98f",
            "id": 4357
        },
        {
            "@type": "WorkflowStep",
            "name": "Hunt for LSASS Driver",
            "description": null,
            "arguments": {
                "route": "35d8f364-a53d-43ae-9024-a075c7778d95",
                "title": "T1547.008 - Hunt for LSASS Driver",
                "resources": [
                    "hunt"
                ],
                "inputVariables": [
                    {
                        "name": "siem",
                        "type": "picklists",
                        "label": "SIEM",
                        "title": "Picklist",
                        "usable": true,
                        "tooltip": "Choose your SIEM",
                        "dataType": "picklist",
                        "formType": "picklist",
                        "required": true,
                        "_expanded": true,
                        "mmdUpdate": true,
                        "collection": false,
                        "dataSource": {
                            "model": "picklists",
                            "query": {
                                "sort": [
                                    {
                                        "field": "orderIndex",
                                        "direction": "ASC"
                                    }
                                ],
                                "logic": "AND",
                                "filters": [
                                    {
                                        "field": "listName__name",
                                        "value": "SIEMs",
                                        "operator": "eq"
                                    }
                                ]
                            },
                            "displayConditions": {
                                "876c1483-416b-4d2f-8138-15769ae16d5c": {
                                    "conditions": null,
                                    "visibility": "visible"
                                },
                                "bcebcab1-3f93-468a-9f3f-91e5c511a0b5": {
                                    "conditions": null,
                                    "visibility": "visible"
                                }
                            }
                        },
                        "searchable": false,
                        "templateUrl": "app\/components\/form\/fields\/typeahead.html",
                        "_nameTouched": true,
                        "defaultValue": {
                            "id": 280,
                            "@id": "\/api\/3\/picklists\/876c1483-416b-4d2f-8138-15769ae16d5c",
                            "icon": null,
                            "@type": "Picklist",
                            "color": null,
                            "display": "Elastic",
                            "listName": "\/api\/3\/picklist_names\/98830189-afff-40e6-bed1-94012551dc67",
                            "itemValue": "Elastic",
                            "orderIndex": 1
                        },
                        "displayTemplate": "{{ itemValue }}",
                        "lengthConstraint": false,
                        "allowedEncryption": false,
                        "allowedGridColumn": true,
                        "useRecordFieldDefault": false
                    }
                ],
                "step_variables": {
                    "input": {
                        "params": {
                            "siem": "{{vars.request.data[\"siem\"]}}",
                            "sourceIP": "{{ vars.sourceIP }}",
                            "processID": "{{ vars.processID }}",
                            "sourcetool": "{{ vars.sourcetool }}",
                            "accountname": "{{ vars.accountname }}",
                            "commandline": "{{ vars.commandline }}",
                            "processGUID": "{{ vars.processGUID }}",
                            "processname": "{{ vars.processname }}",
                            "computername": "{{ vars.computername }}",
                            "destinationIP": "{{ vars.destinationIP }}",
                            "parentprocessGUID": "{{ vars.parentprocessGUID }}",
                            "parentprocessname": "{{ vars.parentprocessname }}"
                        },
                        "records": "{{vars.input.records}}"
                    },
                    "useMockOutput": "{{globalVars.Demo_mode}}"
                },
                "_promptexpanded": true,
                "displayConditions": {
                    "hunt": {
                        "sort": [],
                        "limit": 30,
                        "logic": "AND",
                        "filters": []
                    },
                    "alerts": {
                        "sort": [],
                        "limit": 30,
                        "logic": "AND",
                        "filters": []
                    }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
            },
            "status": null,
            "top": "430",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
            "uuid": "c9035e0b-e89f-450a-a3b6-079006a84b80",
            "id": 4358
        },
        {
            "@type": "WorkflowStep",
            "name": "Splunk query for illegitimate LSASS",
            "description": null,
            "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                    "query": "index=sysmon EventCode=1 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} Image=\"*lsass.exe\" Image!=\"C:\\\\Windows\\\\System32\\\\lsass.exe\" Image!=\"C:\\\\Windows\\\\SysWOW64\\\\lsass.exe\"   | table  host Image MD5 ParentImage User CommandLine process_exec vendor_product TimeCreated ParentProcessId ProcessId ParentCommandLine ProcessGuid UtcTime EventChannel Computer",
                    "exec_mode": "",
                    "auto_cancel": "",
                    "latest_time": "",
                    "earliest_time": "",
                    "additional_search_args": "{\"A\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
            },
            "status": null,
            "top": "670",
            "left": "1100",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "a5339dad-2978-41c6-9e45-8138eafa597e",
            "id": 4359
        },
        {
            "@type": "WorkflowStep",
            "name": "Splunk query for DLL load from illegitimate LSASS",
            "description": null,
            "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                    "query": "index=sysmon EventCode=7 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} Image=\"*lsass.exe\" Image!=\"C:\\\\Windows\\\\System32\\\\*\" Image!=\"C:\\\\Windows\\\\SysWOW64\\\\*\" ImageLoaded!=\"C:\\\\Windows\\\\System32\\\\*\" ImageLoaded!=\"C:\\\\Windows\\\\SysWOW64\\\\*\" ImageLoaded!=\"C:\\\\Program Files\\\\*\" ImageLoaded!=\"C:\\\\Program Files (x86)\\\\*\"  | table host Image MD5 ParentImage User CommandLine process_exec vendor_product TimeCreated ParentProcessId ProcessId ParentCommandLine Image_File_Name UtcTime EventChannel ProcessGuid Computer",
                    "exec_mode": "",
                    "auto_cancel": "",
                    "latest_time": "",
                    "earliest_time": "",
                    "additional_search_args": "{\"a\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
            },
            "status": null,
            "top": "830",
            "left": "1100",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "f33af52b-a9d6-43ff-9512-682e34623a6e",
            "id": 4360
        },
        {
            "@type": "WorkflowStep",
            "name": "Create and Link Elastic Alert 2",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{vars.steps.Elastic_query_for_DLL_load_from_illegitimate_LSASS.data.hits.hits}}",
                    "parallel": false,
                    "condition": ""
                },
                "arguments": {
                    "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                    "url": "",
                    "source": "{{vars.item._source.source_name}}",
                    "comment": "SIEM query indicated that a file named LSASS.exe was executed from a nonstandard directory and attempted to load a DLL from a non-standard directory on {{vars.item._source.beat.hostname}} at {{vars.item._source.event_data.UtcTime}}.",
                    "huntIRI": "{{vars.input.records[0]['@id']}}",
                    "service": "",
                    "filePath": "{{vars.item._source.image_path}}",
                    "hostName": "{{vars.item._source.beat.hostname}}",
                    "sourceIP": "",
                    "userName": "{{vars.item._source.username}}",
                    "alertName": "ATT&CK-LSASS Driver-{{vars.item._source.event_data.Image}} loaded as illegitimate Lsass",
                    "alertType": "{{\"AlertType\" | picklist(\"Boot or Logon Autostart Execution\", \"@id\")}}",
                    "epochTime": "{{ arrow.get(vars.item._source.event_data.UtcTime).timestamp }}",
                    "eventName": "",
                    "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                    "processID": "{{vars.item._source.event_data.ProcessId}}",
                    "technique": "LSASS Driver-DLL Loaded by Illegitimate LSASS",
                    "sourceData": "{{vars.item}}",
                    "sourceTool": "{{vars.item._source.source_name}}",
                    "commandline": "{{vars.item._source.event_data.CommandLine}}",
                    "description": "A process named LSASS.exe was invoked from a nonstandard directory and attempted to load a DLL file. This may be an attempt by an adversary to execute their own code while masquerading as a legitimate process. The suspicious LSASS.exe process and the DLL file it attempted to execute should be investigated.",
                    "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                    "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                    "registryKey": "",
                    "sourceImage": "",
                    "targetImage": "{{vars.item._source.event_data.ImageLoaded}}",
                    "computerName": "{{vars.item._source.computer_name}}",
                    "destinationIP": "",
                    "mitre_tech_id": "T1547.008",
                    "parentProcess": "{{vars.item._source.parent_image_path}}",
                    "scheduledTask": "",
                    "bitstransferid": "",
                    "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                    "bytestransferred": "",
                    "registryKeyValue": "",
                    "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                    "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "\/api\/3\/workflows\/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
            },
            "status": null,
            "top": "350",
            "left": "1750",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "uuid": "50b94f2c-d2f9-4806-93e4-a6dc5da39c44",
            "id": 4361
        },
        {
            "@type": "WorkflowStep",
            "name": "Create and Link Alert 1",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{vars.steps.Get_Results_1.data.results}}",
                    "parallel": false,
                    "condition": ""
                },
                "arguments": {
                    "MD5": "{{vars.item.MD5}}",
                    "url": "",
                    "source": "{{vars.item.EventChannel}}",
                    "comment": "SIEM query indicated LSASS.exe attempted to load a DLL from a non-standard directory on {{vars.item.host}} at {{vars.item.UtcTime}}.",
                    "huntIRI": "{{vars.input.records[0]['@id']}}",
                    "service": "",
                    "filePath": "{{vars.item.Image}}",
                    "hostName": "{{vars.item.host}}",
                    "sourceIP": "null",
                    "userName": "{{vars.item.User}}",
                    "alertName": "ATT&CK-LSASS Driver-{{vars.item.ImageLoaded}} by LSASS",
                    "alertType": "{{\"AlertType\" | picklist(\"Boot or Logon Autostart Execution\", \"@id\")}}",
                    "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                    "eventName": "",
                    "eventTime": "{{vars.item.UtcTime}}",
                    "processID": "{{vars.item.ProcessId}}",
                    "technique": "LSASS Driver-Illegitimate DLL Loaded",
                    "sourceData": "{{vars.item}}",
                    "sourceTool": "{{vars.item.EventChannel}}",
                    "commandline": "{{vars.item.CommandLine}}",
                    "description": "LSASS.exe attempted to execute a DLL file located in a nonstandard directory. This could be an attempt by an adversary in the network to execute their code to gain persistence or further access to the system. The DLL being loaded by LSASS.exe should be evaluated to determine its legitimacy.",
                    "processGUID": "{{vars.item.ProcessGuid}}",
                    "processName": "{{vars.item.process_exec}}",
                    "registryKey": "",
                    "sourceImage": "",
                    "targetImage": "{{vars.item.ImageLoaded}}",
                    "computerName": "{{vars.item.Computer}}",
                    "destinationIP": "null",
                    "mitre_tech_id": "T1177",
                    "parentProcess": "{{vars.item.ParentImage}}",
                    "scheduledTask": "",
                    "bitstransferid": "",
                    "parentProcessID": "{{vars.item.ParentProcessId}}",
                    "bytestransferred": "",
                    "registryKeyValue": "",
                    "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                    "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "\/api\/3\/workflows\/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
            },
            "status": null,
            "top": "510",
            "left": "1750",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "uuid": "7e854895-8f61-4e91-ba8f-5eacdb6ccaa1",
            "id": 4362
        },
        {
            "@type": "WorkflowStep",
            "name": "Elastic query for DLL load from illegitimate LSASS",
            "description": null,
            "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                    "index": "logstash-beats-*",
                    "query": "event_type:sysmon AND event_id:\"7\" AND @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND image_path.keyword:*lsass.exe NOT image_path.keyword:C\\:\\\\Windows\\\\*ystem32\\\\* NOT image_path.keyword:C\\:\\\\Windows\\\\SysWOW64\\\\* NOT event_data.ImageLoaded.keyword:C\\:\\\\Windows\\\\*ystem32\\\\* NOT event_data.ImageLoaded:.keywordC\\:\\\\Windows\\\\SysWOW64\\\\* NOT event_data.ImageLoaded.keyword:C\\:\\\\Program\\ Files\\\\* NOT event_data.ImageLoaded.keyword:C\\:\\\\Program\\ Files\\ \\(x86\\)\\\\*",
                    "run_as_user": ""
                },
                "version": "2.2.1",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "mock_result": "{\n  \"data\": {\n    \"hits\": {\n      \"hits\": [\n        {\n          \"_id\": \"Il1sdWsBlqecEBF3LUYC\",\n          \"_type\": \"doc\",\n          \"_index\": \"logstash-beats-lsassdriver\",\n          \"_score\": 3.287682,\n          \"_source\": {\n            \"beat\": {\n              \"name\": \"admin-PC4\",\n              \"version\": \"6.5.3\",\n              \"hostname\": \"admin-PC4\"\n            },\n            \"tags\": [\n              \"beat\",\n              \"beats_input_codec_plain_applied\"\n            ],\n            \"task\": \"Image loaded (rule: ImageLoad)\",\n            \"user\": {\n              \"name\": \"SYSTEM\",\n              \"type\": \"User\",\n              \"domain\": \"NT AUTHORITY\",\n              \"identifier\": \"S-1-5-18\"\n            },\n            \"level\": \"Information\",\n            \"opcode\": \"Info\",\n            \"message\": \"Image loaded:\\nRuleName: \\nUtcTime: 2019-06-20 15:05:52.933\\nProcessGuid: {D1BE7B41-0000-0000-0000-001067AA0501}\\nProcessId: 1888\\nImage: C:\\\\Users\\\\superman\\\\Desktop\\\\lsass.exe\\nImageLoaded: C:\\\\Users\\\\superman\\\\Desktop\\\\lsass.exe\\nFileVersion: 2.1.1.0\\nDescription: mimikatz for Windows\\nProduct: mimikatz\\nCompany: gentilkiwi (Benjamin DELPY)\\nOriginalFileName: mimikatz.exe\\nHashes: MD5=332A5371389A8953A96BF09B69EDCB6E,SHA256=E46BA4BDD4168A399EE5BC2161A8C918095FA30EB20AC88CAC6AB1D6DBEA2B4A\\nSigned: true\\nSignature: Open Source Developer, Benjamin Delpy\\nSignatureStatus: Valid\",\n            \"version\": 3,\n            \"@version\": \"1\",\n            \"event_id\": 7,\n            \"log_name\": \"Microsoft-Windows-Sysmon\/Operational\",\n            \"beat_host\": {\n              \"id\": \"d1be7b41-2fc5-49e3-9ff1-ec91443d27c3\",\n              \"os\": {\n                \"build\": \"7601.0\",\n                \"family\": \"windows\",\n                \"version\": \"6.1\",\n                \"platform\": \"windows\"\n              },\n              \"name\": \"admin-PC4\",\n              \"architecture\": \"x86_64\"\n            },\n            \"thread_id\": 2116,\n            \"@timestamp\": \"2019-06-20T15:05:52.995Z\",\n            \"event_data\": {\n              \"Hashes\": \"MD5=332A5371389A8953A96BF09B69EDCB6E,SHA256=E46BA4BDD4168A399EE5BC2161A8C918095FA30EB20AC88CAC6AB1D6DBEA2B4A\",\n              \"Signed\": \"true\",\n              \"Company\": \"gentilkiwi (Benjamin DELPY)\",\n              \"Product\": \"mimikatz\",\n              \"UtcTime\": \"2019-06-20 15:05:52.933\",\n              \"ProcessId\": \"1888\",\n              \"Signature\": \"Open Source Developer, Benjamin Delpy\",\n              \"Description\": \"mimikatz for Windows\",\n              \"FileVersion\": \"2.1.1.0\",\n              \"ImageLoaded\": \"C:\\\\Users\\\\superman\\\\Desktop\\\\lsass.exe\",\n              \"ProcessGuid\": \"{D1BE7B41-0000-0000-0000-001067AA0501}\",\n              \"SignatureStatus\": \"Valid\",\n              \"OriginalFileName\": \"mimikatz.exe\"\n            },\n            \"event_type\": \"sysmon\",\n            \"image_path\": \"C:\\\\Users\\\\superman\\\\Desktop\\\\lsass.exe\",\n            \"process_id\": 1408,\n            \"source_name\": \"Microsoft-Windows-Sysmon\",\n            \"computer_name\": \"admin-PC4.batman.local\",\n            \"logstash_time\": 0.0015377998352050781,\n            \"provider_guid\": \"{5770385F-C22A-43E0-BF4C-06F5698FFBD9}\",\n            \"record_number\": \"402038\"\n          }\n        }\n      ],\n      \"total\": {\n        \"value\": 1,\n        \"relation\": \"eq\"\n      },\n      \"max_score\": 3.287682\n    },\n    \"took\": 428,\n    \"_shards\": {\n      \"total\": 95,\n      \"failed\": 0,\n      \"skipped\": 0,\n      \"successful\": 95\n    },\n    \"timed_out\": false\n  },\n  \"status\": \"Success\",\n  \"message\": \"\",\n  \"operation\": null\n}",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
            },
            "status": null,
            "top": "350",
            "left": "1425",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "cf41516b-f957-4c49-981b-cd5c6ffbc4fd",
            "id": 4363
        },
        {
            "@type": "WorkflowStep",
            "name": "Set Elastic hunt times",
            "description": null,
            "arguments": {
                "elasticHuntEnd": "{% if vars.input.records[0].huntEnd %} {{ arrow.get(vars.input.records[0].huntEnd).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }} {% else %} now {% endif %}",
                "elasticHuntStart": "{{ arrow.get(vars.input.records[0].huntStart).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }}"
            },
            "status": null,
            "top": "190",
            "left": "1100",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "dae78ba7-66b6-4c7d-920a-8988c96fdbfd",
            "id": 4364
        },
        {
            "@type": "WorkflowStep",
            "name": "Create and Link Alert 2",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{vars.steps.Get_Results_2.data.results}}",
                    "parallel": false,
                    "condition": ""
                },
                "arguments": {
                    "MD5": "{{vars.item.MD5}}",
                    "url": "",
                    "source": "{{vars.item.EventChannel}}",
                    "comment": "SIEM query indicated that a file named LSASS.exe was executed from a nonstandard directory and attempted to load a DLL from a non-standard directory on {{vars.item.host}} at {{vars.item.UtcTime}}.",
                    "huntIRI": "{{vars.input.records[0]['@id']}}",
                    "service": "",
                    "filePath": "{{vars.item.Image}}",
                    "hostName": "{{vars.item.host}}",
                    "sourceIP": "null",
                    "userName": "{{vars.item.User}}",
                    "alertName": "ATT&CK-LSASS Driver-{{vars.item.Image}} loaded by illegitimate Lsass",
                    "alertType": "{{\"AlertType\" | picklist(\"Boot or Logon Autostart Execution\", \"@id\")}}",
                    "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                    "eventName": "",
                    "eventTime": "{{vars.item.UtcTime}}",
                    "processID": "{{vars.item.ProcessId}}",
                    "technique": "LSASS Driver-DLL Loaded by Illegitimate LSASS",
                    "sourceData": "{{vars.item}}",
                    "sourceTool": "{{vars.item.EventChannel}}",
                    "commandline": "{{vars.item.CommandLine}}",
                    "description": "A process named LSASS.exe was invoked from a nonstandard directory and attempted to load a DLL file. This may be an attempt by an adversary to execute their own code while masquerading as a legitimate process. The suspicious LSASS.exe process and the DLL file it attempted to execute should be investigated.",
                    "processGUID": "{{vars.item.ProcessGuid}}",
                    "processName": "{{vars.item.process_exec}}",
                    "registryKey": "",
                    "sourceImage": "",
                    "targetImage": "{{vars.item.ImageLoaded}}",
                    "computerName": "{{vars.item.Computer}}",
                    "destinationIP": "null",
                    "mitre_tech_id": "T1177",
                    "parentProcess": "{{vars.item.ParentImage}}",
                    "scheduledTask": "",
                    "bitstransferid": "",
                    "parentProcessID": "{{vars.item.ParentProcessId}}",
                    "bytestransferred": "",
                    "registryKeyValue": "",
                    "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                    "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "\/api\/3\/workflows\/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
            },
            "status": null,
            "top": "830",
            "left": "1750",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "uuid": "be48e730-fcb5-4915-8f76-121b96d9264f",
            "id": 4365
        },
        {
            "@type": "WorkflowStep",
            "name": "Splunk query for illegitimate DLL load",
            "description": null,
            "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                    "query": "index=sysmon EventCode=7 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} (Image=\"C:\\\\Windows\\\\System32\\\\lsass.exe\" OR Image=\"C:\\\\Windows\\\\SysWOW64\\\\lsass.exe\") ImageLoaded!=\"C:\\\\Windows\\\\System32\\\\*\" ImageLoaded!=\"C:\\\\Windows\\\\SysWOW64\\\\*\" ImageLoaded!=\"C:\\\\Program Files\\\\*\" ImageLoaded!=\"C:\\\\Program Files (x86)\\\\*\" | table  host Image MD5 ParentImage User CommandLine process_exec vendor_product TimeCreated ParentProcessId ProcessId ParentCommandLine Image_File_Name UtcTime EventChannel ProcessGuid Computer",
                    "exec_mode": "",
                    "auto_cancel": "",
                    "latest_time": "",
                    "earliest_time": "",
                    "additional_search_args": "{\"a\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
            },
            "status": null,
            "top": "510",
            "left": "1100",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "d91e7ecc-b39e-48b6-a00b-f52a5618d8e9",
            "id": 4366
        },
        {
            "@type": "WorkflowStep",
            "name": "Create and Link Alert 3",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{vars.steps.Get_Results_3.data.results}}",
                    "parallel": false,
                    "condition": ""
                },
                "arguments": {
                    "MD5": "{{vars.item.MD5}}",
                    "url": "",
                    "source": "{{vars.item.EventChannel}}",
                    "comment": "SIEM query indicated that a file named LSASS.exe was executed from a nonstandard directory on {{vars.item.host}} at {{vars.item.UtcTime}}.",
                    "huntIRI": "{{vars.input.records[0]['@id']}}",
                    "service": "",
                    "filePath": "{{vars.item.Image}}",
                    "hostName": "{{vars.item.host}}",
                    "sourceIP": "null",
                    "userName": "{{vars.item.User}}",
                    "alertName": "ATT&CK-LSASS Driver-Lsass.exe loaded from {{vars.item.Image | regex_search('[^\\*?\"<>|\\r\\n]+(?=lsass\\.exe)')}}",
                    "alertType": "{{\"AlertType\" | picklist(\"Boot or Logon Autostart Execution\", \"@id\")}}",
                    "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                    "eventName": "",
                    "eventTime": "{{vars.item.UtcTime}}",
                    "processID": "{{vars.item.ProcessId}}",
                    "technique": "LSASS Driver-Illegitimate LSASS Executed",
                    "sourceData": "{{vars.item}}",
                    "sourceTool": "{{vars.item.EventChannel}}",
                    "commandline": "{{vars.item.CommandLine}}",
                    "description": "A process named LSASS.exe was invoked from a nonstandard directory. This may be an attempt by an adversary to execute their own code while masquerading as a legitimate process. The suspicious LSASS.exe executable should be investigated for indicators of malicious activity.",
                    "processGUID": "{{vars.item.ProcessGuid}}",
                    "processName": "{{vars.item.process_exec}}",
                    "registryKey": "",
                    "sourceImage": "",
                    "targetImage": "",
                    "computerName": "{{vars.item.Computer}}",
                    "destinationIP": "null",
                    "mitre_tech_id": "T1177",
                    "parentProcess": "{{vars.item.ParentImage}}",
                    "scheduledTask": "",
                    "bitstransferid": "",
                    "parentProcessID": "{{vars.item.ParentProcessId}}",
                    "bytestransferred": "",
                    "registryKeyValue": "",
                    "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                    "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "\/api\/3\/workflows\/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
            },
            "status": null,
            "top": "670",
            "left": "1750",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "uuid": "3549852c-b1c0-40f5-89b5-070803b2d184",
            "id": 4367
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Set Elastic hunt times -> Copy  of Copy  of a",
            "targetStep": "\/api\/3\/workflow_steps\/400ab8c0-352c-4abe-ae3a-9284e13c3eb3",
            "sourceStep": "\/api\/3\/workflow_steps\/dae78ba7-66b6-4c7d-920a-8988c96fdbfd",
            "label": null,
            "isExecuted": false,
            "uuid": "662303a5-2ccd-447e-b80c-5b41e8290520"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Which SIEM -> Set Elastic hunt times",
            "targetStep": "\/api\/3\/workflow_steps\/dae78ba7-66b6-4c7d-920a-8988c96fdbfd",
            "sourceStep": "\/api\/3\/workflow_steps\/02c023f4-78c9-4470-a215-d197bd64058b",
            "label": null,
            "isExecuted": false,
            "uuid": "7799c78e-b42c-40ca-8c90-333a0665038c"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Set Splunk hunt times -> Splunk query for illegitimate DLL load",
            "targetStep": "\/api\/3\/workflow_steps\/d91e7ecc-b39e-48b6-a00b-f52a5618d8e9",
            "sourceStep": "\/api\/3\/workflow_steps\/df303e97-0f23-4ab7-ad1b-4a8fde803a5b",
            "label": null,
            "isExecuted": false,
            "uuid": "6c9160d7-de56-4b20-8c52-ff5182f72d23"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Elastic query for illegitimate DLL load -> Copy  of Copy  of Create and Link Elastic Alert 3",
            "targetStep": "\/api\/3\/workflow_steps\/cfad32ce-5355-46c4-844d-9b2bd8a33fbc",
            "sourceStep": "\/api\/3\/workflow_steps\/400ab8c0-352c-4abe-ae3a-9284e13c3eb3",
            "label": null,
            "isExecuted": false,
            "uuid": "cd979c0f-f1d1-4dd4-b452-91c2c04e5e17"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create and Link Alert 3 -> Deduplicate Comments",
            "targetStep": "\/api\/3\/workflow_steps\/54369d88-df12-4d0b-892d-2e25402f18b5",
            "sourceStep": "\/api\/3\/workflow_steps\/3549852c-b1c0-40f5-89b5-070803b2d184",
            "label": null,
            "isExecuted": false,
            "uuid": "276993de-6463-466b-8db9-600f628ee897"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Elastic query for DLL load from illegitimate LSASS -> Copy  of Create and Link Elastic Alert 3",
            "targetStep": "\/api\/3\/workflow_steps\/50b94f2c-d2f9-4806-93e4-a6dc5da39c44",
            "sourceStep": "\/api\/3\/workflow_steps\/cf41516b-f957-4c49-981b-cd5c6ffbc4fd",
            "label": null,
            "isExecuted": false,
            "uuid": "4a987ef3-2f1f-461a-99ea-5dca0fcc1a3f"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Results for Sysmon Regsvr32 DLL Load -> Copy  of Create Splunk Alert",
            "targetStep": "\/api\/3\/workflow_steps\/be48e730-fcb5-4915-8f76-121b96d9264f",
            "sourceStep": "\/api\/3\/workflow_steps\/5a621a10-3df8-4b33-a1df-594bc059581c",
            "label": null,
            "isExecuted": false,
            "uuid": "67773e6c-5fba-4491-bdd2-0456799d3713"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create and Link Elastic Alert 3 -> Deduplicate Comments",
            "targetStep": "\/api\/3\/workflow_steps\/54369d88-df12-4d0b-892d-2e25402f18b5",
            "sourceStep": "\/api\/3\/workflow_steps\/53b26cf0-d207-45d6-b697-a6b6c7abe98f",
            "label": null,
            "isExecuted": false,
            "uuid": "325b6057-d040-4216-80f6-26f719138a55"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Copy  of Create and Link Elastic Alert 3 -> Deduplicate Comments",
            "targetStep": "\/api\/3\/workflow_steps\/54369d88-df12-4d0b-892d-2e25402f18b5",
            "sourceStep": "\/api\/3\/workflow_steps\/50b94f2c-d2f9-4806-93e4-a6dc5da39c44",
            "label": null,
            "isExecuted": false,
            "uuid": "f02c7bd3-b4ad-4795-969a-7fc99f58410b"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Splunk query for Regsvr32 DLL Load -> Copy  of Get Results for Sysmon Regsvr32 Child",
            "targetStep": "\/api\/3\/workflow_steps\/5a621a10-3df8-4b33-a1df-594bc059581c",
            "sourceStep": "\/api\/3\/workflow_steps\/f33af52b-a9d6-43ff-9512-682e34623a6e",
            "label": null,
            "isExecuted": false,
            "uuid": "64914a79-7970-49e5-b6ce-1c823cf19f69"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Copy  of Copy  of Create and Link Elastic Alert 3 -> Deduplicate Comments",
            "targetStep": "\/api\/3\/workflow_steps\/54369d88-df12-4d0b-892d-2e25402f18b5",
            "sourceStep": "\/api\/3\/workflow_steps\/cfad32ce-5355-46c4-844d-9b2bd8a33fbc",
            "label": null,
            "isExecuted": false,
            "uuid": "902484ab-e563-4c10-962d-b5ae7e9f416e"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Hunt for LSASS Driver -> Which SIEM",
            "targetStep": "\/api\/3\/workflow_steps\/02c023f4-78c9-4470-a215-d197bd64058b",
            "sourceStep": "\/api\/3\/workflow_steps\/c9035e0b-e89f-450a-a3b6-079006a84b80",
            "label": null,
            "isExecuted": false,
            "uuid": "84efc4bd-46de-463e-adba-f55e3a362b64"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create and Link Alert 2 -> Deduplicate Comments",
            "targetStep": "\/api\/3\/workflow_steps\/54369d88-df12-4d0b-892d-2e25402f18b5",
            "sourceStep": "\/api\/3\/workflow_steps\/be48e730-fcb5-4915-8f76-121b96d9264f",
            "label": null,
            "isExecuted": false,
            "uuid": "96283d95-681d-45e9-8496-c19f8fad850a"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Set Elastic hunt times -> a",
            "targetStep": "\/api\/3\/workflow_steps\/53f777da-d699-491c-97aa-4379cebfdfa5",
            "sourceStep": "\/api\/3\/workflow_steps\/dae78ba7-66b6-4c7d-920a-8988c96fdbfd",
            "label": null,
            "isExecuted": false,
            "uuid": "547cd2fd-7c92-42a9-827d-3712528381ae"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Splunk query for illegitimate LSASS -> Copy  of Get Results 2",
            "targetStep": "\/api\/3\/workflow_steps\/0197411d-b551-4130-a3f2-585b11dfd8bf",
            "sourceStep": "\/api\/3\/workflow_steps\/a5339dad-2978-41c6-9e45-8138eafa597e",
            "label": null,
            "isExecuted": false,
            "uuid": "41ca6a64-6e81-4e48-8ec4-724d5b1f809f"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Which SIEM -> Set Splunk hunt times",
            "targetStep": "\/api\/3\/workflow_steps\/df303e97-0f23-4ab7-ad1b-4a8fde803a5b",
            "sourceStep": "\/api\/3\/workflow_steps\/02c023f4-78c9-4470-a215-d197bd64058b",
            "label": null,
            "isExecuted": false,
            "uuid": "4f475147-bd61-44c3-bdfb-dfe3c87528fa"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Set Elastic hunt times -> Copy  of a",
            "targetStep": "\/api\/3\/workflow_steps\/cf41516b-f957-4c49-981b-cd5c6ffbc4fd",
            "sourceStep": "\/api\/3\/workflow_steps\/dae78ba7-66b6-4c7d-920a-8988c96fdbfd",
            "label": null,
            "isExecuted": false,
            "uuid": "f364f13c-3fc9-41b0-bd98-188e1bc89553"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Splunk query for Sysmon CMSTP -> Get Results for Sysmon CMSTP",
            "targetStep": "\/api\/3\/workflow_steps\/00a13090-fa74-4f80-83a2-1be49c9f1a9b",
            "sourceStep": "\/api\/3\/workflow_steps\/d91e7ecc-b39e-48b6-a00b-f52a5618d8e9",
            "label": null,
            "isExecuted": false,
            "uuid": "5dda0b8f-8dc9-4a8e-9814-2d31ca0594e1"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Results for Sysmon Regsvr32 Child -> Create Splunk Alert",
            "targetStep": "\/api\/3\/workflow_steps\/7e854895-8f61-4e91-ba8f-5eacdb6ccaa1",
            "sourceStep": "\/api\/3\/workflow_steps\/00a13090-fa74-4f80-83a2-1be49c9f1a9b",
            "label": null,
            "isExecuted": false,
            "uuid": "82cb55d1-4b56-4909-a7c5-f9c4f74768f6"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Elastic query for illegitimate LSASS -> Copy 1 of Create and Link Alert 3",
            "targetStep": "\/api\/3\/workflow_steps\/53b26cf0-d207-45d6-b697-a6b6c7abe98f",
            "sourceStep": "\/api\/3\/workflow_steps\/53f777da-d699-491c-97aa-4379cebfdfa5",
            "label": null,
            "isExecuted": false,
            "uuid": "b8411984-3be9-480a-8e0f-7e7f288b98d3"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Set Splunk hunt times -> Splunk query for illegitimate LSASS",
            "targetStep": "\/api\/3\/workflow_steps\/a5339dad-2978-41c6-9e45-8138eafa597e",
            "sourceStep": "\/api\/3\/workflow_steps\/df303e97-0f23-4ab7-ad1b-4a8fde803a5b",
            "label": null,
            "isExecuted": false,
            "uuid": "ecaaeada-fbc6-4b49-b974-77ffd9a9f58c"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Set Splunk hunt times -> Splunk query for DLL load from illegitimate LSASS",
            "targetStep": "\/api\/3\/workflow_steps\/f33af52b-a9d6-43ff-9512-682e34623a6e",
            "sourceStep": "\/api\/3\/workflow_steps\/df303e97-0f23-4ab7-ad1b-4a8fde803a5b",
            "label": null,
            "isExecuted": false,
            "uuid": "eaa03ed3-f7aa-4d9a-aab2-1afdb6f30641"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Copy  of Get Results 3 -> Copy  of Copy  of Create Splunk Alert",
            "targetStep": "\/api\/3\/workflow_steps\/3549852c-b1c0-40f5-89b5-070803b2d184",
            "sourceStep": "\/api\/3\/workflow_steps\/0197411d-b551-4130-a3f2-585b11dfd8bf",
            "label": null,
            "isExecuted": false,
            "uuid": "9306789a-7bbb-4493-b582-e62006c37d01"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create and Link Alert 1 -> Deduplicate Comments",
            "targetStep": "\/api\/3\/workflow_steps\/54369d88-df12-4d0b-892d-2e25402f18b5",
            "sourceStep": "\/api\/3\/workflow_steps\/7e854895-8f61-4e91-ba8f-5eacdb6ccaa1",
            "label": null,
            "isExecuted": false,
            "uuid": "1122cf3d-2b98-453c-a801-679a1f45a9a3"
        }
    ],
    "priority": null,
    "uuid": "583e8a71-535b-4566-a16e-026722755190",
    "recordTags": [
        "ManualTrigger"
    ],
    "id": 1111,
    "createUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
    "createDate": 1644165543,
    "modifyUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
    "modifyDate": 1644165543,
    "owners": [],
    "isPrivate": false
}